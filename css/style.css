:root{--bg:#1e1e1e;--panel:#252526;--text:#ddd;--accent:#007acc;--green:#6a9955;--red:#f44747;--border:#444;--link:#666;--node-bg:#2d2d30;--input-bg:#333}
[data-theme=light]{--bg:#f5f5f5;--panel:#e0e0e0;--text:#222;--accent:#0066cc;--border:#ccc;--link:#999;--node-bg:#fff;--input-bg:#f0f0f0}
body{margin:0;font-family:Segoe UI,sans-serif;background:var(--bg);color:var(--text);height:100vh;display:flex;flex-direction:column;overflow:hidden;transition:all .3s}
.header{padding:10px 20px;background:var(--panel);display:flex;align-items:center;gap:12px;flex-wrap:wrap;border-bottom:1px solid var(--border);z-index:10}
.header h1{margin:0;font-size:18px;color:#61afef}
button{padding:7px 12px;background:var(--accent);color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:13px}
button:hover{filter:brightness(1.2)}
button.small{padding:5px 9px;font-size:12px}
button.green{background:#218c21}
button.blue{background:#1e90ff}
button.danger{background:#d16969}
.dropdown{position:relative;display:inline-block}
.dropdown button{background:#444}
.dropdown-menu{position:absolute;top:100%;right:0;background:var(--panel);border:1px solid var(--border);border-radius:4px;min-width:160px;display:none;z-index:100}
.dropdown:hover .dropdown-menu{display:block}
.dropdown-menu div{padding:8px 12px;cursor:pointer}
.dropdown-menu div:hover{background:var(--accent);color:#fff}
.right{display:flex;gap:8px;align-items:center}
#main{flex:1;display:flex;overflow:hidden}
#sidebar{width:100%;padding:15px;overflow-y:auto;overflow-x:hidden;height:100%}
#tree-container{width:60%;background:var(--bg);border-left:1px solid var(--border)}
#tree-container.hidden{display:none}
#classic-view.fullscreen #sidebar{width:100%}
#classic-view.fullscreen #tree-container{display:none!important}
.bottom-bar{padding:8px 20px;background:var(--panel);display:flex;justify-content:flex-end;gap:10px;border-top:1px solid var(--border)}
textarea{width:100%;height:160px;background:#1e1e1e;color:#d4d4d4;font-family:Consolas;padding:10px;border:none;resize:none}
.input-group{margin-bottom:12px;display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.node{margin:12px 0;padding:14px;background:var(--node-bg);border-radius:8px;border-left:5px solid var(--accent);box-shadow:0 2px 8px rgba(0,0,0,.2)}
.node.rng{border-left-color:#c586c0}
.node.spawn{border-left-color:var(--green);background:rgba(106,153,85,.1)}
.header-node{display:flex;align-items:center;gap:12px;margin-bottom:10px;cursor:pointer;user-select:none;font-weight:600}
.header-node::before{content:"Collapse ";color:var(--accent)}
.collapsed>.header-node::before{content:"Expand "}
.collapsed>.children{display:none}
.children{margin-left:32px;border-left:2px dashed var(--border);padding-left:18px}
.prob{margin-left:auto;font-size:.9em;background:rgba(255,255,255,.1);padding:2px 8px;border-radius:4px;cursor:help}
.item-field{flex:1;padding:6px 10px;background:var(--input-bg);color:var(--text);border:1px solid var(--border);border-radius:4px}
.link{fill:none;stroke:var(--link);stroke-width:2}
#events-tabs{display:flex;gap:8px;margin:10px 0;flex-wrap:wrap}
.tab{padding:6px 12px;background:#444;border:none;border-radius:4px;color:#fff;cursor:pointer;font-size:12px}
.tab.active,.tab.add{background:var(--accent)}
